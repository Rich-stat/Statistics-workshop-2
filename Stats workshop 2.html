<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistics workshop 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Stats workshop 2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Stats workshop 2_files/libs/quarto-html/quarto.js"></script>
<script src="Stats workshop 2_files/libs/quarto-html/popper.min.js"></script>
<script src="Stats workshop 2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Stats workshop 2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Stats workshop 2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Stats workshop 2_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Stats workshop 2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Stats workshop 2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Stats workshop 2_files/libs/bootstrap/bootstrap-d5ac29a56adf641187225d49675c3d41.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="Stats workshop 2_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="Stats workshop 2_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="Stats workshop 2_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistics workshop 2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="testing-for-differences-for-more-than-two-groups" class="level2">
<h2 class="anchored" data-anchor-id="testing-for-differences-for-more-than-two-groups">Testing for Differences for More than Two Groups</h2>
<p>This workshop introduces you to analysing<br></p>
<ul>
<li>the effects of one or two factors on an outcome measured across more than two independent groups of subjects (1-Factor &amp; 2-Factor ANOVAs),<br></li>
<li>the effects of a factor on an outcome measured more than twice from the same subjects (repeated or within-subjects ANOVA),<br></li>
<li>the effect of a factor while controlling for a covariate that also affects an outcome (ANCOVA).<br></li>
</ul>
<p>First, open RStudio and a new R Script file. Load the packages that you will be using:</p>
<div class="callout callout-style-simple callout-important callout-titled" title="Click to see packages to install (Copy and paste to Script editor)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see packages to install (Copy and paste to Script editor)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pastecs)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>NB</em> If you get a message saying that a package does not exist, you need to install it first with <code>install.packages("name_of_package")</code></p>
</div>
</div>
</div>
<p><br> <br><strong>SELECT THE RELEVANT TAB BELOW FOR YOUR DATA</strong></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href=""><strong>1-FACTOR ANOVA</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href=""><strong>2-FACTOR ANOVA</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href=""><strong>REPEATED MEASURES ANOVA</strong></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href=""><strong>ANCOVA</strong></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>This example is based on an experiment to test if drugs can reduce cholesterol levels. Subjects were randomly divided into 3 groups: One group is given no drug (control group), the second is given Drug 1 and the third group is given Drug 2.</p>
<p><br> <strong>1. Download the Excel file</strong> <code>1-Factor_ANOVA_cholesterol.xlsx</code> from Canvas to your Downloads folder and make it available to RStudio.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Upload excel file to RStudio Cloud">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Upload excel file to RStudio Cloud
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Check that the data in the file is ‘tidy’</li>
<li>Upload it to RStudio Cloud, saving it to a folder for this Statistics Workshop 2 session (<em>NB</em> If you are using RStudio on your own laptop, simply save the excel file to a relevant folder on your laptop).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="upload%201-factor.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Uploading a file to RStudio"><img src="upload%201-factor.png" class="img-fluid figure-img" style="width:70.0%" alt="Uploading a file to RStudio"></a></p>
<figcaption>Uploading a file to RStudio</figcaption>
</figure>
</div>
<ul>
<li>In RStudio, locate the file and set the folder location as your working directory.</li>
</ul>
</div>
</div>
</div>
<p><br> <strong>2. Import the file to RStudio and store it as a dataframe called <em>anova_1_factor</em>.</strong><br> The <code>head()</code> function shows us the first 6 rows:<br></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">'1-Factor_ANOVA_cholesterol.xlsx'</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(anova_1_factor)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1" data-code-annotation="1">Imports the excel file to a dataframe object called ‘anova_1_factor’</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="2">Shows the first 6 rows of the dataframe</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the first 6 rows of the dataframe">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the first 6 rows of the dataframe
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">137</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">115</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">144</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">173</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="odd">
<td style="text-align: left;">153</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: left;">144</td>
<td style="text-align: left;">Control</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As you can see, the dataframe is ‘tidy’, containing two columns (variables), one with all of the Cholesterol measurements for each person and the 2nd variable records to which treatment group each person was allocated. Each person’s information is in a separate row.</p>
</div>
</div>
</div>
<p><br> The <code>summarise_all(class)</code> function shows us what type of data is stored in the dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise_all</span>(class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the variable data types">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the variable data types
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">character</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This shows that the Group variable has been imported as character data (<em>ie</em> text). The groups are categories, and so we wnat to change them to a factor variable.</p>
</div>
</div>
</div>
<p><br>We want to change the Group column to be a factor rather than character data because it contains categories (<em>ie</em> Control, Drug 1 and Drug 2 categories):</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="ot">&lt;-</span> anova_1_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">as.factor</span>(Group))</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Sends the dataframe to the mutate function which changes the Group variable to a factor and calls it Group again (<em>ie</em> it overwrites the column). Result stored in a dataframe of the same name (anova_1_factor)</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">Shows the data types in each column</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the data types">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the data types
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">factor</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br>Save the dataframe as an RData file so that you do not have to import the xlsx file and change the variable data types again. You can just load this dataframe another time when you want to use it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(anova_1_factor, <span class="at">file =</span> <span class="st">"anova_1_factor.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br> <strong>3. EXPLORE THE DATA: descriptive statistics and plots</strong><br> <strong>3.1 Descriptives</strong><br> To obtain summary cholesterol descriptive statistics for each group (control, drug1 and drug2) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-1" class="code-annotation-target"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(Cholesterol <span class="sc">~</span> Group, <span class="at">data =</span> anova_1_factor, <span class="at">quant =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="1" data-code-annotation="1">Produces summary data of Cholesterol grouped by the Group factor from the dataframe anova_1_factor</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the descriptive data">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the descriptive data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
Group: Control
            vars  n   mean    sd median trimmed   mad min max range  skew
Cholesterol    1 20 140.45 21.18  138.5  141.38 24.46 102 173    71 -0.15
            kurtosis   se Q0.25 Q0.75
Cholesterol    -1.14 4.74 128.5   162
------------------------------------------------------------ 
Group: Drug_1
            vars  n  mean    sd median trimmed   mad min max range  skew
Cholesterol    1 20 118.1 21.56  114.5  118.56 26.69  82 151    69 -0.03
            kurtosis   se Q0.25 Q0.75
Cholesterol    -1.29 4.82 101.5 135.5
------------------------------------------------------------ 
Group: Drug_2
            vars  n   mean    sd median trimmed   mad min max range skew
Cholesterol    1 20 102.55 16.94    101  101.88 17.79  80 130    50 0.33
            kurtosis   se Q0.25 Q0.75
Cholesterol    -1.25 3.79 88.25 111.5</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><br> <br> <strong>3.2 Plots</strong><br> Let’s plot a boxplot and a bar chart (just because we can!).<br> <br> First the boxplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> Group, <span class="at">y=</span> Cholesterol)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-3" class="code-annotation-target"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">'lightblue'</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3">3</button><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">15</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="4">4</button><span id="annotated-cell-7-5" class="code-annotation-target"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Cholesterol 1-Factor ANOVA Data"</span>,</span>
<span id="annotated-cell-7-6"><a href="#annotated-cell-7-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"(square = mean, thick line = median)"</span>,</span>
<span id="annotated-cell-7-7"><a href="#annotated-cell-7-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Group"</span>,</span>
<span id="annotated-cell-7-8"><a href="#annotated-cell-7-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="1">Sends the anova_1_factor dataframe to the ggplot() function, with the Group variable on the x-axis and Cholesterol on the y-axis</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="3" data-code-annotation="2">Creates a boxplot with blue fill, a black square as the mean value, and the title and axes labelled</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="3">This line adds a black square point for the mean values</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="5" data-code-annotation="4">The labs() function allows you to add a title, sub-title and x and y axis labels</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the boxplot">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the boxplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/boxAN1a-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br><br> And now the bar chart.<br> First, we must calculate the means and standard deviations (SDs) for each Group and store them in a table object called <code>anova_mean_table</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a>anova_mean_table <span class="ot">&lt;-</span> anova_1_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_chol =</span> <span class="fu">mean</span>(Cholesterol),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD_chol =</span> <span class="fu">sd</span>(Cholesterol))</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3">3</button><span id="annotated-cell-8-5" class="code-annotation-target"><a href="#annotated-cell-8-5" aria-hidden="true" tabindex="-1"></a>anova_mean_table</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="1">groups the data in the dataframe by the Group variable</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="2">Creates 2 new columns: mean_chol with the mean Cholesterol value and SD_chol with the SD</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="5" data-code-annotation="3">This line calls the table so that we can see its contents</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the table with the mean and SD values">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the table with the mean and SD values
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: left;">mean_chol</th>
<th style="text-align: left;">SD_chol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">140.45</td>
<td style="text-align: left;">21.18211</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">118.10</td>
<td style="text-align: left;">21.55995</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">102.55</td>
<td style="text-align: left;">16.93789</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br> Then, use those means and SDs in the <code>anova_mean_table</code> to create a bar plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-1" class="code-annotation-target"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a>anova_mean_table <span class="sc">|&gt;</span></span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>mean_chol), <span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-4" class="code-annotation-target"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">ymin=</span>mean_chol<span class="sc">-</span>SD_chol, <span class="at">ymax=</span>mean_chol<span class="sc">+</span>SD_chol), <span class="at">width=</span><span class="fl">0.1</span>, <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.75</span>, <span class="at">linewidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-5" class="code-annotation-target"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean Cholesterol Values in the 3 Groups"</span>,</span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bars = standard deviation"</span>,</span>
<span id="annotated-cell-9-7"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="1" data-code-annotation="1">Sends the new <code>anova_mean_table</code> contents to the ggplot() function to plot a bar chart with Group on the x-axis and the mean cholesterol values on the y-axis</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="4" data-code-annotation="2">This line creates the SD error bars on the bar chart: mean cholesterol +/- SD. <code>width</code> sets the width of the caps at each end of the vertical line, <code>linewidth</code> sets the thickness of the error bar lines</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="5" data-code-annotation="3">The labs() function allows you to add a title, sub-title and x and y axis labels</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the barplot">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the barplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/barAN1a-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="NOTE: If you want to specify the order of the Drugs on the x-axis, click here">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
NOTE: If you want to specify the order of the Drugs on the x-axis, click here
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By default, the x-values are plotted in alphabetical and numerical order. Use the <code>fct_relevel()</code> function to specify the order of the x-values if you want to change this. <br>In these plots <em>Group</em> is the main variable placed on the x-axis.<br><br> a) for this boxplot, use:<br> <code>anova_1_factor$Group &lt;- fct_relevel(anova_1_factor$Group, "Control", "Drug_1", "Drug_2")</code><br> <br> b) for this barplot, use:<br> <code>anova_mean_table$Group &lt;- fct_relevel(anova_mean_table$Group, "Control", "Drug_1", "Drug_2")</code></p>
</div>
</div>
</div>
<p><br> <br> <strong>4. ASSUMPTIONS</strong><br> <strong>4.1 Test if the data in the 3 groups is normally distributed</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-2" class="code-annotation-target"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Cholesterol)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="2" data-code-annotation="1">First groups the data by the Group variable (control, drug1 and drug2)</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="3" data-code-annotation="2">Then carries out the Shapiro-Wilk test for normality on the grouped data</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the Shapiro-Wilk test output">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the Shapiro-Wilk test output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: left;">variable</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.9542885</td>
<td style="text-align: left;">0.4368926</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.9545435</td>
<td style="text-align: left;">0.4413377</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.9188555</td>
<td style="text-align: left;">0.0941863</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br> <strong>4.2 Homogeneity test (<em>ie</em> are the variances in the 3 groups similar?)</strong> <br>P&gt;0.05 means that variances are homogeneous.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Cholesterol <span class="sc">~</span> Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the Levene's test output">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the Levene’s test output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">df1</th>
<th style="text-align: left;">df2</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">0.688909</td>
<td style="text-align: left;">0.5062551</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p>In this case, the data in the 3 groups are normally distributed (P&gt;0.05) and the variances are homogeneous (P&gt;0.05). <br> <br> <br> <br><strong>Question: Are the mean values of the 3 groups statistically significantly different (<em>ie</em>, do Drug 1 and Drug 2 both reduce cholesterol in the 3 independent groups of people</strong><br></p>
<p><br><br></p>
<section id="the-anova-analysis" class="level6">
<h6 class="anchored" data-anchor-id="the-anova-analysis"><code>5.</code> <strong>THE ANOVA ANALYSIS:</strong></h6>
</section>
<section id="if-the-data-is-normally-distributed-the-variances-are-homogeneous" class="level6">
<h6 class="anchored" data-anchor-id="if-the-data-is-normally-distributed-the-variances-are-homogeneous"><code>5.1</code> <strong>IF THE DATA IS NORMALLY DISTRIBUTED &amp; THE VARIANCES ARE HOMOGENEOUS</strong></h6>
<p><strong>The ANOVA:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cholesterol <span class="sc">~</span> Group, <span class="at">between =</span> Group, <span class="at">effect.size =</span> <span class="st">'pes'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the ANOVA">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the ANOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: left;">DFn</th>
<th style="text-align: left;">DFd</th>
<th style="text-align: left;">F</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">p&lt;.05</th>
<th style="text-align: left;">pes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">18.142</td>
<td style="text-align: left;">8e-07</td>
<td style="text-align: left;">*</td>
<td style="text-align: left;">0.389</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>NB</em> ‘pes’ = partial eta squared effect size:<br> eta<sup>2</sup> of 0.01 = small effect,<br>eta<sup>2</sup> of 0.06 = medium effect,<br>eta<sup>2</sup> of 0.14 = large effect.<br><br> Here, P &lt; 8x10<sup>-7</sup>, <em>ie</em> much less than 0.05, and so there is a statistically sigificant difference between at least 2 of the groups.</p>
</div>
</div>
</div>
<p>To find out which group differs statistically significantly from each other, use a multiple comparison test. <br><br> <strong>Tukey multiple comparison:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tukey_hsd</span>(Cholesterol <span class="sc">~</span> Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the multiple comparison">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the multiple comparison
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: left;">group1</th>
<th style="text-align: left;">group2</th>
<th style="text-align: left;">null.value</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
<th style="text-align: left;">p.adj</th>
<th style="text-align: left;">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-22.35</td>
<td style="text-align: left;">-37.57209</td>
<td style="text-align: left;">-7.1279055</td>
<td style="text-align: left;">2.34e-03</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-37.90</td>
<td style="text-align: left;">-53.12209</td>
<td style="text-align: left;">-22.6779055</td>
<td style="text-align: left;">4.00e-07</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-15.55</td>
<td style="text-align: left;">-30.77209</td>
<td style="text-align: left;">-0.3279055</td>
<td style="text-align: left;">4.42e-02</td>
<td style="text-align: left;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If the <code>p.adj</code> value is &lt;0.05, the two groups are statistically significantly different.<br> Here, both Drug 1 and Drug 2 are significantly different to the Control group, and they are just significantly different to each other (P=0.044).</p>
</div>
</div>
</div>
<p><br><br> <strong>Power</strong> (must be a balanced ANOVA with same numbers in each group):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">3</span>, <span class="at">n=</span><span class="dv">20</span>, <span class="at">f=</span><span class="fl">0.389</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where k = number of balanced groups, n=number in each group<br> f = calculated effect size from eta_squared above<br> Leave <code>power=NULL</code> because this is the value we want to calculate.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the power analysis">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the power analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 3
              n = 20
              f = 0.389
      sig.level = 0.05
          power = 0.7510442

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>So, the power of this test is 75.1%.</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="if-the-data-is-normally-distributed-the-variances-are-not-homogeneous" class="level6">
<h6 class="anchored" data-anchor-id="if-the-data-is-normally-distributed-the-variances-are-not-homogeneous"><code>5.2</code> <strong>IF THE DATA IS NORMALLY DISTRIBUTED &amp; THE VARIANCES ARE NOT HOMOGENEOUS</strong></h6>
<p><strong>The ANOVA:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cholesterol <span class="sc">~</span> Group, <span class="at">between =</span> Group, <span class="at">effect.size =</span> <span class="st">'pes'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the ANOVA result">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the ANOVA result
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: left;">DFn</th>
<th style="text-align: left;">DFd</th>
<th style="text-align: left;">F</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">p&lt;.05</th>
<th style="text-align: left;">pes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">18.142</td>
<td style="text-align: left;">8e-07</td>
<td style="text-align: left;">*</td>
<td style="text-align: left;">0.389</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>NB</em> ‘pes’ = partial eta squared effect size:<br> eta<sup>2</sup> of 0.01 = small effect,<br>eta<sup>2</sup> of 0.06 = medium effect,<br>eta<sup>2</sup> of 0.14 = large effect.<br><br> Here, P &lt; 8x10<sup>-7</sup>, <em>ie</em> much less than 0.05, and so there is a statistically sigificant difference between at least 2 of the groups.</p>
</div>
</div>
</div>
<p><br><br> <strong>Games-Howell multiple comparison test:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">games_howell_test</span>(Cholesterol <span class="sc">~</span> Group, <span class="at">conf.level =</span> <span class="fl">0.95</span>, <span class="at">detailed =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the Games-Howell output">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the Games-Howell output
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: left;">group1</th>
<th style="text-align: left;">group2</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
<th style="text-align: left;">p.adj</th>
<th style="text-align: left;">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">-22.35</td>
<td style="text-align: left;">-38.83271</td>
<td style="text-align: left;">-5.8672867</td>
<td style="text-align: left;">6.0e-03</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">-37.90</td>
<td style="text-align: left;">-52.71925</td>
<td style="text-align: left;">-23.0807481</td>
<td style="text-align: left;">9.0e-07</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">-15.55</td>
<td style="text-align: left;">-30.53568</td>
<td style="text-align: left;">-0.5643203</td>
<td style="text-align: left;">4.1e-02</td>
<td style="text-align: left;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>All comparisons have a P-values less than 0.05, and so each group is statistically significantly different to every other</p>
</div>
</div>
</div>
<p><br><br> <strong>Power</strong> (must be balanced ANOVA with same numbers in each group):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.anova.test</span>(<span class="at">k=</span><span class="dv">3</span>, <span class="at">n=</span><span class="dv">20</span>, <span class="at">f=</span><span class="fl">0.389</span>, <span class="at">sig.level=</span><span class="fl">0.05</span>, <span class="at">power=</span><span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where k = number of balanced groups, n=number in each group<br> f = calculated effect size from eta_squared above<br> Leave <code>power=NULL</code> because this is the value we want to calculate.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the power analysis">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the power analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 3
              n = 20
              f = 0.389
      sig.level = 0.05
          power = 0.7510442

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>So, the power of this test is 75.1%.</p>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="if-the-data-is-not-normally-distributed" class="level6">
<h6 class="anchored" data-anchor-id="if-the-data-is-not-normally-distributed"><code>5.3</code> <strong>IF THE DATA IS NOT NORMALLY DISTRIBUTED</strong></h6>
<p><strong>Kruskal-Wallis test:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kruskal_test</span>(Cholesterol <span class="sc">~</span> Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the Kruskal-Wallis test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the Kruskal-Wallis test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: left;">n</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">23.02421</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1e-05</td>
<td style="text-align: left;">Kruskal-Wallis</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>P&lt;0.05, so there is a statistically significant difference betwen at least 2 groups.</p>
</div>
</div>
</div>
<p><br><br> <strong>Effect size:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kruskal_effsize</span>(Cholesterol <span class="sc">~</span> Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the effect size">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the effect size
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">effsize</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">magnitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">0.3688457</td>
<td style="text-align: left;">eta2[H]</td>
<td style="text-align: left;">large</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br><br> <strong>Dunn’s multiple comparison test</strong> (with the Bonferroni correction to reduce the chance of a Type 1 error):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>anova_1_factor <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dunn_test</span>(Cholesterol <span class="sc">~</span> Group, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>, <span class="at">detailed =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the multiple comparison">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the multiple comparison
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: left;">group1</th>
<th style="text-align: left;">group2</th>
<th style="text-align: right;">n1</th>
<th style="text-align: right;">n2</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">p.adj</th>
<th style="text-align: left;">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">-2.626412</td>
<td style="text-align: right;">0.0086290</td>
<td style="text-align: right;">0.0258871</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">-4.790939</td>
<td style="text-align: right;">0.0000017</td>
<td style="text-align: right;">0.0000050</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">-2.164526</td>
<td style="text-align: right;">0.0304240</td>
<td style="text-align: right;">0.0912720</td>
<td style="text-align: left;">ns</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Use the <code>p.adj</code> value to decide if a comparison is statistically significantly different.<br> In this case Drugs 1 and 2 are both significantly different to the Control group, but they are not significantly different to each other (P=0.09)</p>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>This example is one in which subjects are assigned to one of 3 treatment groups (Factor 1: Control, Drug 1 or Drug 2, as in the 1-Factor example). However, in this case we also want to find out if gender (Factor 2) affects the cholesterol results as well as treatment, and whether the effect of treatment depends on the gender (an interaction of the two factors)<br></p>
<p><strong>1. Download and prepare the data</strong><br> Download the excel file <code>2-factor_ANOVA_cholesterol.xlsx</code> from Canvas to your Downloads folder and make it available to RStudio.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Upload excel file to RStudio Cloud">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Upload excel file to RStudio Cloud
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Check that the data in the file is ‘tidy’</li>
<li>Upload it to RStudio Cloud, saving it to a folder for this Statistics Workshop 2 session (<em>NB</em> If you are using RStudio on your own laptop, simply save the excel file to a relevant folder on your laptop).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="upload%202-factor.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Uploading a file to RStudio"><img src="upload%202-factor.png" class="img-fluid figure-img" style="width:70.0%" alt="Uploading a file to RStudio"></a></p>
<figcaption>Uploading a file to RStudio</figcaption>
</figure>
</div>
<ul>
<li>In RStudio, locate the file and set the folder location as your working directory.</li>
</ul>
</div>
</div>
</div>
<p><br><strong>2. Now import the data</strong><br></p>
<ul>
<li>Save it as a dataframe called ‘<em>aov_2_factor</em>’,</li>
<li>view the 1st 6 rows to see the arrangement of the data, and</li>
<li>check the data types in each column.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-24"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="1">1</button><span id="annotated-cell-24-1" class="code-annotation-target"><a href="#annotated-cell-24-1" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"2-Factor_ANOVA_cholesterol.xlsx"</span>)</span>
<span id="annotated-cell-24-2"><a href="#annotated-cell-24-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="2">2</button><span id="annotated-cell-24-3" class="code-annotation-target"><a href="#annotated-cell-24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(aov_2_factor)</span>
<span id="annotated-cell-24-4"><a href="#annotated-cell-24-4" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="3">3</button><span id="annotated-cell-24-5" class="code-annotation-target"><a href="#annotated-cell-24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-24" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-24" data-code-lines="1" data-code-annotation="1">Imports the excel file and stores the data in a dataframe object called ‘aov_2_factor’</span>
</dd>
<dt data-target-cell="annotated-cell-24" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-24" data-code-lines="3" data-code-annotation="2">To see the first 6 rows of the dataframe</span>
</dd>
<dt data-target-cell="annotated-cell-24" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-24" data-code-lines="5" data-code-annotation="3">To see the types of datat in each column</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the 1st 6 rows of data">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the 1st 6 rows of data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">137</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: left;">115</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="odd">
<td style="text-align: left;">144</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: left;">173</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="odd">
<td style="text-align: left;">153</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
</tr>
<tr class="even">
<td style="text-align: left;">144</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You can see that the data is ‘tidy’ with 3 variables: one for the cholesterol measurements for each person, the 2nd for the treatment group to which each person has been allocated, and the 3rd for the gender of each person. Each person’s details are in separate rows.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the types of data in each variable">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the types of data in each variable
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">character</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The variables ‘Group’ and ‘Gender’ have been imported as character data (text).</p>
</div>
</div>
</div>
<p><br> The variables ‘Group’ and ‘Gender’ are character data at the moment. We need to change these to factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="ot">&lt;-</span> aov_2_factor <span class="sc">|&gt;</span></span>
<span id="annotated-cell-25-2"><a href="#annotated-cell-25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">as.factor</span>(Group),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1">1</button><span id="annotated-cell-25-3" class="code-annotation-target"><a href="#annotated-cell-25-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Gender =</span> <span class="fu">as.factor</span>(Gender))</span>
<span id="annotated-cell-25-4"><a href="#annotated-cell-25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-25-5"><a href="#annotated-cell-25-5" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="2">2</button><span id="annotated-cell-25-6" class="code-annotation-target"><a href="#annotated-cell-25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="3" data-code-annotation="1">Sends the dataframe to mutate() which converts Group to a factor and Gender to a factor. Stores result in a dataframe of the same name (<em>ie</em> over-writes the dataframe)</span>
</dd>
<dt data-target-cell="annotated-cell-25" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="6" data-code-annotation="2">Checks the data types of the 3 variables</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the types of data in each variable">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the types of data in each variable
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">factor</td>
<td style="text-align: left;">factor</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br>Save the dataframe as an RData file so that you do not have to do the above steps again if you want to use this data.:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(aov_2_factor, <span class="at">file =</span> <span class="st">"aov_2_factor.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br> <strong>3. EXPLORE THE DATA</strong> <br> <code>3a</code> <strong>Descriptives:</strong><br> Provides the summary statistics of cholesterol for each group</p>
<div class="cell" data-messages="false">
<div class="sourceCode cell-code" id="annotated-cell-27"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-27" data-target-annotation="1">1</button><span id="annotated-cell-27-1" class="code-annotation-target"><a href="#annotated-cell-27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(Cholesterol <span class="sc">~</span> Group <span class="sc">+</span> Gender, <span class="at">data =</span> aov_2_factor, <span class="at">quant =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-27" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-27" data-code-lines="1" data-code-annotation="1">Gets descriptives of Cholesterol by Group</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the descriptive statistics">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the descriptive statistics
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-messages="false">
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
Group: Control
Gender: Female
            vars  n  mean    sd median trimmed   mad min max range  skew
Cholesterol    1 10 145.4 22.01    151  147.75 22.98 104 168    64 -0.45
            kurtosis   se  Q0.25  Q0.75
Cholesterol    -1.35 6.96 129.75 164.25
------------------------------------------------------------ 
Group: Drug_1
Gender: Female
            vars  n  mean   sd median trimmed   mad min max range skew kurtosis
Cholesterol    1 10 119.3 18.6    119  118.62 23.72  93 151    58 0.12    -1.35
              se  Q0.25 Q0.75
Cholesterol 5.88 105.75 132.5
------------------------------------------------------------ 
Group: Drug_2
Gender: Female
            vars  n mean    sd median trimmed   mad min max range skew kurtosis
Cholesterol    1 10 99.2 18.12   94.5   97.62 16.31  81 130    49 0.58    -1.34
              se Q0.25 Q0.75
Cholesterol 5.73 85.25   108
------------------------------------------------------------ 
Group: Control
Gender: Male
            vars  n  mean    sd median trimmed   mad min max range skew
Cholesterol    1 10 135.5 20.21    137     135 17.05 102 173    71 0.11
            kurtosis   se Q0.25 Q0.75
Cholesterol    -0.85 6.39 122.5   144
------------------------------------------------------------ 
Group: Drug_1
Gender: Male
            vars  n  mean    sd median trimmed   mad min max range  skew
Cholesterol    1 10 116.9 25.15  113.5  117.38 34.84  82 148    66 -0.03
            kurtosis   se Q0.25  Q0.75
Cholesterol    -1.67 7.95 99.25 140.75
------------------------------------------------------------ 
Group: Drug_2
Gender: Male
            vars  n  mean    sd median trimmed   mad min max range skew
Cholesterol    1 10 105.9 15.89  105.5  106.12 14.08  80 130    50 0.11
            kurtosis   se Q0.25 Q0.75
Cholesterol     -1.2 5.03  95.5 112.5</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><br><br> And we’ll plot a boxplot and a bar chart (just because we can!)<br> <code>3b</code> <strong>Boxplot</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-28"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-28-1"><a href="#annotated-cell-28-1" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="1">1</button><span id="annotated-cell-28-2" class="code-annotation-target"><a href="#annotated-cell-28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="annotated-cell-28-3"><a href="#annotated-cell-28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> Group,           </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="2">2</button><span id="annotated-cell-28-4" class="code-annotation-target"><a href="#annotated-cell-28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> Cholesterol,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="3">3</button><span id="annotated-cell-28-5" class="code-annotation-target"><a href="#annotated-cell-28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="4">4</button><span id="annotated-cell-28-6" class="code-annotation-target"><a href="#annotated-cell-28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="annotated-cell-28-7"><a href="#annotated-cell-28-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of 2-factor ANOVA data"</span>,</span>
<span id="annotated-cell-28-8"><a href="#annotated-cell-28-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-28" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="2" data-code-annotation="1">Sends aov_2_factor dataframe to the ggplot() function</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="4" data-code-annotation="2">Puts Group on the x-axis and Cholesterol on the y-axis</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="5" data-code-annotation="3">Colours bars by gender</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="6" data-code-annotation="4">Creates a boxplot with title and axis labels</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the boxplot">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the boxplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/box2fact1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br><br> <code>3c</code> <strong>Bar chart</strong><br> A bar chart clustered for males and females.<br> First calculate means and SD values and store them in a table object called <code>anova_table_2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-29"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-29-1"><a href="#annotated-cell-29-1" aria-hidden="true" tabindex="-1"></a>anova_table_2 <span class="ot">&lt;-</span> aov_2_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1">1</button><span id="annotated-cell-29-2" class="code-annotation-target"><a href="#annotated-cell-29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group, Gender) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-29-3"><a href="#annotated-cell-29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_chol =</span> <span class="fu">mean</span>(Cholesterol),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="2">2</button><span id="annotated-cell-29-4" class="code-annotation-target"><a href="#annotated-cell-29-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD_chol =</span> <span class="fu">sd</span>(Cholesterol))</span>
<span id="annotated-cell-29-5"><a href="#annotated-cell-29-5" aria-hidden="true" tabindex="-1"></a>anova_table_2 </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="2" data-code-annotation="1">Group the Cholesterol data by Group and then Gender</span>
</dd>
<dt data-target-cell="annotated-cell-29" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="4" data-code-annotation="2">Create new columns ‘mean_chol’ for the mean values and ‘SD_chol’ for the SD values</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the table of means and SDs">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the table of means and SDs
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Gender</th>
<th style="text-align: left;">mean_chol</th>
<th style="text-align: left;">SD_chol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">145.4</td>
<td style="text-align: left;">22.01111</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">135.5</td>
<td style="text-align: left;">20.20588</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">119.3</td>
<td style="text-align: left;">18.59540</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">116.9</td>
<td style="text-align: left;">25.14602</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">99.2</td>
<td style="text-align: left;">18.11568</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">105.9</td>
<td style="text-align: left;">15.89165</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br> Then use the values in the table to create the bar chart</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-30"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="1">1</button><span id="annotated-cell-30-1" class="code-annotation-target"><a href="#annotated-cell-30-1" aria-hidden="true" tabindex="-1"></a>dodge <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>)</span>
<span id="annotated-cell-30-2"><a href="#annotated-cell-30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-30-3"><a href="#annotated-cell-30-3" aria-hidden="true" tabindex="-1"></a>anova_table_2 <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="2">2</button><span id="annotated-cell-30-4" class="code-annotation-target"><a href="#annotated-cell-30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Group, <span class="at">y =</span> mean_chol, <span class="at">fill =</span> Gender)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="3">3</button><span id="annotated-cell-30-5" class="code-annotation-target"><a href="#annotated-cell-30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> dodge, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="4">4</button><span id="annotated-cell-30-6" class="code-annotation-target"><a href="#annotated-cell-30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_chol<span class="sc">-</span>SD_chol, <span class="at">ymax=</span>mean_chol<span class="sc">+</span>SD_chol), <span class="at">position =</span> dodge, <span class="at">width=</span> <span class="fl">0.1</span>, <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.75</span>, <span class="at">linewidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="annotated-cell-30-7"><a href="#annotated-cell-30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart of 2-Factor ANOVA Cholesterol data"</span>,</span>
<span id="annotated-cell-30-8"><a href="#annotated-cell-30-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bars = standard deviation"</span>,</span>
<span id="annotated-cell-30-9"><a href="#annotated-cell-30-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-30" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="1" data-code-annotation="1">Manual adjustment of dodge width so that males and females are clustered next to each for each group</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="4" data-code-annotation="2">Sends the new table to the ggplot() function with Group on the x-axis, mean values on the y-axis and bars coloured by gender</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="5" data-code-annotation="3">Creates a clustered bar chart with male and female groups next to each other</span>
</dd>
<dt data-target-cell="annotated-cell-30" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-30" data-code-lines="6" data-code-annotation="4">Creates error bars of SD (mean +/- SD), width of the caps and the linewidths of the error bars.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the bar chart">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the bar chart
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/bar2fact1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="NOTE: If you want to specify the order of the treatment on the x-axis, click here">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
NOTE: If you want to specify the order of the treatment on the x-axis, click here
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By default, the x-values are plotted in alphabetical and numerical order. Use the <code>fct_relevel()</code> function to specify the order of the x-values if you want to change this. <br>In these plots <em>Group</em> is the main variable placed on the x-axis.<br><br> a) for this boxplot, use:<br> <code>aov_2_factor$Group &lt;- fct_relevel(aov_2_factor$Group, "Control", "Drug_1", "Drug_2")</code><br> <br> b) for this barplot, use:<br> <code>anova_table_2$Group &lt;- fct_relevel(anova_table_2$Group, "Control", "Drug_1", "Drug_2")</code></p>
</div>
</div>
</div>
<p><br> <br> <strong>4. ASSUMPTIONS</strong><br> <code>4.1</code> <strong>Examine if the data is normally distributed:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-31"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-31-1"><a href="#annotated-cell-31-1" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="1">1</button><span id="annotated-cell-31-2" class="code-annotation-target"><a href="#annotated-cell-31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group, Gender) <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="2">2</button><span id="annotated-cell-31-3" class="code-annotation-target"><a href="#annotated-cell-31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Cholesterol)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-31" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="2" data-code-annotation="1">Groups the data by Group and then Gender</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="3" data-code-annotation="2">Carries out the Shapiro-Wilk test for each group of data</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the Shapiro-Wilk test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the Shapiro-Wilk test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Gender</th>
<th style="text-align: left;">variable</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.8674326</td>
<td style="text-align: left;">0.0932982</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.9829299</td>
<td style="text-align: left;">0.9789039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.9707697</td>
<td style="text-align: left;">0.8978890</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.9096503</td>
<td style="text-align: left;">0.2785977</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.8696048</td>
<td style="text-align: left;">0.0989106</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">0.9640594</td>
<td style="text-align: left;">0.8309773</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The P-values for all groups are &gt;0.05, and so the data are normally distributed.</p>
</div>
</div>
</div>
<p><br><br> <strong>4.2 Test if the variances in the groups are equal:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Cholesterol <span class="sc">~</span> Group<span class="sc">*</span>Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the Levene's test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the Levene’s test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">df1</th>
<th style="text-align: left;">df2</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">0.6778125</td>
<td style="text-align: left;">0.6420988</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>P=0.64, and so the variances of the data in the groups are not significantly different.</p>
</div>
</div>
</div>
<p><br><br> <strong>5.ANOVA</strong><br> <code>5.1</code> <strong>The 2-factor anova:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-33"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-33-1"><a href="#annotated-cell-33-1" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-33" data-target-annotation="1">1</button><span id="annotated-cell-33-2" class="code-annotation-target"><a href="#annotated-cell-33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cholesterol <span class="sc">~</span> Group <span class="sc">+</span> Gender <span class="sc">+</span> Group<span class="sc">*</span>Gender, <span class="at">effect.size =</span> <span class="st">"pes"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-33" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-33" data-code-lines="2" data-code-annotation="1">Carries out an anova for the effect of (a) Group, (b) Gender and (c) any interaction between Group and Gender</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the anova">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the anova
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: right;">DFn</th>
<th style="text-align: right;">DFd</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p</th>
<th style="text-align: left;">p&lt;.05</th>
<th style="text-align: right;">pes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">17.766</td>
<td style="text-align: right;">1.20e-06</td>
<td style="text-align: left;">*</td>
<td style="text-align: right;">0.397</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gender</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0.128</td>
<td style="text-align: right;">7.22e-01</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">54</td>
<td style="text-align: right;">0.846</td>
<td style="text-align: right;">4.35e-01</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">0.030</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><em>NB<sub>1</sub></em> pes = partial eta square effect sizes:<br>eta<sup>2</sup> of 0.01 = small effect,<br>eta<sup>2</sup> of 0.06 = medium effect,<br>eta<sup>2</sup> of 0.14 = large effect.<br><br> <em>NB<sub>2</sub></em> Here, only Group (<em>ie</em> the drug treatment) has a statistically significant effect on Cholesterol. Both gender and the interaction term have P-values greater than 0.05 (0.722 and 0.435, respectively). So gender does not have an effect overall, and the effect of a drug does not depend on the gender of the person receiving it (the Group:Gender interaction term).<br><br></p>
</div>
</div>
</div>
<p><br><br><br> <strong>5.2 Multiple comparison test:</strong><br> Compares every group with every other group.<br><br> <em>NB</em> If homogeneity of variance is not true, use the Games_Howell multiple comparison test - see 1-FACTOR ANOVA tab, section 5.2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>aov_2_factor <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tukey_hsd</span>(Cholesterol <span class="sc">~</span> Group <span class="sc">+</span> Gender <span class="sc">+</span> Group<span class="sc">*</span>Gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the multiple comparison">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the multiple comparison
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: left;">group1</th>
<th style="text-align: left;">group2</th>
<th style="text-align: left;">null.value</th>
<th style="text-align: left;">estimate</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
<th style="text-align: left;">p.adj</th>
<th style="text-align: left;">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-22.350000</td>
<td style="text-align: left;">-37.755058</td>
<td style="text-align: left;">-6.9449424</td>
<td style="text-align: left;">2.70e-03</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-37.900000</td>
<td style="text-align: left;">-53.305058</td>
<td style="text-align: left;">-22.4949424</td>
<td style="text-align: left;">7.00e-07</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-15.550000</td>
<td style="text-align: left;">-30.955058</td>
<td style="text-align: left;">-0.1449424</td>
<td style="text-align: left;">4.74e-02</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gender</td>
<td style="text-align: left;">Female</td>
<td style="text-align: left;">Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-1.866667</td>
<td style="text-align: left;">-12.330523</td>
<td style="text-align: left;">8.5971900</td>
<td style="text-align: left;">7.22e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Control:Female</td>
<td style="text-align: left;">Drug_1:Female</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-26.100000</td>
<td style="text-align: left;">-52.808235</td>
<td style="text-align: left;">0.6082348</td>
<td style="text-align: left;">5.90e-02</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Control:Female</td>
<td style="text-align: left;">Drug_2:Female</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-46.200000</td>
<td style="text-align: left;">-72.908235</td>
<td style="text-align: left;">-19.4917652</td>
<td style="text-align: left;">6.14e-05</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Control:Female</td>
<td style="text-align: left;">Control:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-9.900000</td>
<td style="text-align: left;">-36.608235</td>
<td style="text-align: left;">16.8082348</td>
<td style="text-align: left;">8.81e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Control:Female</td>
<td style="text-align: left;">Drug_1:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-28.500000</td>
<td style="text-align: left;">-55.208235</td>
<td style="text-align: left;">-1.7917652</td>
<td style="text-align: left;">3.00e-02</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Control:Female</td>
<td style="text-align: left;">Drug_2:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-39.500000</td>
<td style="text-align: left;">-66.208235</td>
<td style="text-align: left;">-12.7917652</td>
<td style="text-align: left;">7.75e-04</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_1:Female</td>
<td style="text-align: left;">Drug_2:Female</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-20.100000</td>
<td style="text-align: left;">-46.808235</td>
<td style="text-align: left;">6.6082348</td>
<td style="text-align: left;">2.44e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_1:Female</td>
<td style="text-align: left;">Control:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">16.200000</td>
<td style="text-align: left;">-10.508235</td>
<td style="text-align: left;">42.9082348</td>
<td style="text-align: left;">4.79e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_1:Female</td>
<td style="text-align: left;">Drug_1:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-2.400000</td>
<td style="text-align: left;">-29.108235</td>
<td style="text-align: left;">24.3082348</td>
<td style="text-align: left;">1.00e+00</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_1:Female</td>
<td style="text-align: left;">Drug_2:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-13.400000</td>
<td style="text-align: left;">-40.108235</td>
<td style="text-align: left;">13.3082348</td>
<td style="text-align: left;">6.77e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_2:Female</td>
<td style="text-align: left;">Control:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">36.300000</td>
<td style="text-align: left;">9.591765</td>
<td style="text-align: left;">63.0082348</td>
<td style="text-align: left;">2.43e-03</td>
<td style="text-align: left;">**</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_2:Female</td>
<td style="text-align: left;">Drug_1:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">17.700000</td>
<td style="text-align: left;">-9.008235</td>
<td style="text-align: left;">44.4082348</td>
<td style="text-align: left;">3.79e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_2:Female</td>
<td style="text-align: left;">Drug_2:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">6.700000</td>
<td style="text-align: left;">-20.008235</td>
<td style="text-align: left;">33.4082348</td>
<td style="text-align: left;">9.76e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Control:Male</td>
<td style="text-align: left;">Drug_1:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-18.600000</td>
<td style="text-align: left;">-45.308235</td>
<td style="text-align: left;">8.1082348</td>
<td style="text-align: left;">3.25e-01</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Control:Male</td>
<td style="text-align: left;">Drug_2:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-29.600000</td>
<td style="text-align: left;">-56.308235</td>
<td style="text-align: left;">-2.8917652</td>
<td style="text-align: left;">2.17e-02</td>
<td style="text-align: left;">*</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Gender</td>
<td style="text-align: left;">Drug_1:Male</td>
<td style="text-align: left;">Drug_2:Male</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">-11.000000</td>
<td style="text-align: left;">-37.708235</td>
<td style="text-align: left;">15.7082348</td>
<td style="text-align: left;">8.27e-01</td>
<td style="text-align: left;">ns</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br> <em>NB<sub>1</sub></em>. Here, we only need to do a mult comparison test for Group, because Gender has no statistically significant effect (P&gt;0.05 in the anova).<br> <em>NB<sub>2</sub></em>. pwr package does not produce power analysis for 2-Factor ANOVA</p>
</div>
</div>
</div>
<p><br><br></p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>When more than two measurements are repeatedly taken from the same subject, use a repeated measures ANOVA to identify if the mean measurements taken at the different times are significantly different.<br> Here, cholesterol was measured in 18 subjects at the start and then 4 weeks and 8 weeks after they were asked to consume a margerine that is designed to reduce cholesterol. Does cholesterol fall in the 18 people (irrespective of their starting level of cholesterol)?<br></p>
<p><br><strong>1. Download the file</strong> <code>ANOVA_RM_cholesterol.xlsx</code> from Canvas to your Downloads folder and make it available to RStudio.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Upload excel file to RStudio Cloud">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Upload excel file to RStudio Cloud
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Check that the data in the file is ‘tidy’</li>
<li>Upload it to RStudio Cloud, saving it to a folder for this Statistics Workshop 2 session (<em>NB</em> If you are using RStudio on your own laptop, simply save the excel file to a relevant folder on your laptop).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="upload%20RM.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Uploading a file to RStudio"><img src="upload%20RM.png" class="img-fluid figure-img" style="width:70.0%" alt="Uploading a file to RStudio"></a></p>
<figcaption>Uploading a file to RStudio</figcaption>
</figure>
</div>
<ul>
<li>In RStudio, locate the file and set the folder location as your working directory.</li>
</ul>
</div>
</div>
</div>
<p><br></p>
<p><strong>2. Import the data and save it as a dataframe called ‘chol_RM’</strong><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"ANOVA_RM_Cholesterol.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br> View the whole dataframe carefully. Note the arrangement of the data: the ‘Before’, ‘After.4.weeks’ and ‘After.8.weeks’ columns have been placed in 1 column headed ‘Time’. Similarly, all of the Cholesterol values are in 1 column.<br> The ID of each person has also been placed in the first column</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>chol_RM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the whole dataframe">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the whole dataframe
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The data is tidy: each row represents one observation and each column is a different variable:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time</th>
<th style="text-align: left;">Cholesterol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.42</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">4.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">8.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">7.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">8.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">5.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">5.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">3.91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">7.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">7.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">5.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">18</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">5.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">5.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">6.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">5.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">4.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">7.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">7.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">7.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">4.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">5.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">3.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">6.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">5.59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">5.56</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">7.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">6.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">6.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">4.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">18</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">5.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">6.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">4.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">7.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">7.05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">7.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">4.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">3.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.96</td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.64</td>
</tr>
<tr class="odd">
<td style="text-align: left;">13</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">14</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">6.96</td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">6.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">6.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">4.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">18</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.17</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br> Check the types of data in each column/variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the types of data in each column">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the types of data in each column
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time</th>
<th style="text-align: left;">Cholesterol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">numeric</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The Time variable has been imported as text (‘character’). The other two columns are numeric.</p>
</div>
</div>
</div>
<p>The Time variable has been imported as text (‘character’). So, we need to convert it to a factor because the time intervals are categories.<br><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="ot">&lt;-</span> chol_RM <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Time =</span> <span class="fu">as.factor</span>(Time))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the types of data in each column">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the types of data in each column
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ID</th>
<th style="text-align: left;">Time</th>
<th style="text-align: left;">Cholesterol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">factor</td>
<td style="text-align: left;">numeric</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can now see that Time is a factor.</p>
</div>
</div>
</div>
<p><br><br> Save the dataframe as an RData file to your working directory so you don’t have to import the xlsx file again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(chol_RM, <span class="at">file =</span> <span class="st">"chol_RM.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br> <br> <strong>3. EXPLORE THE DATA</strong><br> <br> <code>3.1</code> <strong>Get the descriptive summary data:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-41"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-41" data-target-annotation="1">1</button><span id="annotated-cell-41-1" class="code-annotation-target"><a href="#annotated-cell-41-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">describeBy</span>(Cholesterol <span class="sc">~</span> Time, <span class="at">data =</span> chol_RM, <span class="at">quant =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-41" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-41" data-code-lines="1" data-code-annotation="1">Groups Cholesterol by Time and gets descriptives for each Time group</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the summary descriptive statistics for each Time group">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the summary descriptive statistics for each Time group
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
Time: After.4.weeks
            vars  n mean   sd median trimmed  mad min  max range  skew kurtosis
Cholesterol    1 18 5.84 1.12   5.83    5.86 1.27 3.7 7.71  4.01 -0.14    -1.07
              se Q0.25 Q0.75
Cholesterol 0.26  5.18  6.73
------------------------------------------------------------ 
Time: After.8.weeks
            vars  n mean  sd median trimmed mad  min  max range  skew kurtosis
Cholesterol    1 18 5.78 1.1   5.73    5.79 1.2 3.66 7.67  4.01 -0.16    -0.98
              se Q0.25 Q0.75
Cholesterol 0.26  5.21  6.69
------------------------------------------------------------ 
Time: Before
            vars  n mean   sd median trimmed  mad  min  max range  skew
Cholesterol    1 18 6.41 1.19    6.5    6.44 1.19 3.91 8.43  4.52 -0.26
            kurtosis   se Q0.25 Q0.75
Cholesterol    -0.77 0.28  5.74  7.22</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><br><br> <code>3.2</code> <strong>Boxplot and bar plot:</strong><br> <br> <strong>The Boxplot</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-42"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="1">1</button><span id="annotated-cell-42-1" class="code-annotation-target"><a href="#annotated-cell-42-1" aria-hidden="true" tabindex="-1"></a>chol_RM<span class="sc">$</span>Time <span class="ot">&lt;-</span> <span class="fu">fct_relevel</span>(chol_RM<span class="sc">$</span>Time, <span class="st">"Before"</span>, <span class="st">"After.4.weeks"</span>, <span class="st">"After.8.weeks"</span>)</span>
<span id="annotated-cell-42-2"><a href="#annotated-cell-42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-42-3"><a href="#annotated-cell-42-3" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="2">2</button><span id="annotated-cell-42-4" class="code-annotation-target"><a href="#annotated-cell-42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>Cholesterol)) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="3">3</button><span id="annotated-cell-42-5" class="code-annotation-target"><a href="#annotated-cell-42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="4">4</button><span id="annotated-cell-42-6" class="code-annotation-target"><a href="#annotated-cell-42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">15</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="5">5</button><span id="annotated-cell-42-7" class="code-annotation-target"><a href="#annotated-cell-42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Cholesterol RM ANOVA Data"</span>,</span>
<span id="annotated-cell-42-8"><a href="#annotated-cell-42-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"(square = mean, thick line = median)"</span>,</span>
<span id="annotated-cell-42-9"><a href="#annotated-cell-42-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Duration of consumption of margarine"</span>,</span>
<span id="annotated-cell-42-10"><a href="#annotated-cell-42-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-42" data-target-annotation="6">6</button><span id="annotated-cell-42-11" class="code-annotation-target"><a href="#annotated-cell-42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Before"</span><span class="ot">=</span><span class="st">"At start"</span>, <span class="st">"After.4.weeks"</span><span class="ot">=</span><span class="st">"4 Weeks"</span>, <span class="st">"After.8.weeks"</span><span class="ot">=</span><span class="st">"8 Weeks"</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-42" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="1" data-code-annotation="1">This selects the <em>Time</em> column in the <em>chol_RM</em> dataframe, and ensures that the Time categories appear in the graph in the order specified here (default is to display them in alphabetical order).</span>
</dd>
<dt data-target-cell="annotated-cell-42" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="4" data-code-annotation="2">Sends the dataframe to ggplot() and puts Time on the x-axis and Cholesterol on the y-axis</span>
</dd>
<dt data-target-cell="annotated-cell-42" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="5" data-code-annotation="3">Creates a boxplot</span>
</dd>
<dt data-target-cell="annotated-cell-42" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="6" data-code-annotation="4">Creates a black square to represent the mean value</span>
</dd>
<dt data-target-cell="annotated-cell-42" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="7" data-code-annotation="5">Type your title, subtitle and axis titles here</span>
</dd>
<dt data-target-cell="annotated-cell-42" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-42" data-code-lines="11" data-code-annotation="6">Renames the categories in the Time column to appear as labels on the x-axis</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the boxplot">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the boxplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/boxRM1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br><br> <strong>The Barplot</strong><br> 1st calculate the mean and SD values and store them in a table object called <code>anova_rm_table</code>:<br></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-43"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-43-1"><a href="#annotated-cell-43-1" aria-hidden="true" tabindex="-1"></a>anova_rm_table <span class="ot">&lt;-</span> chol_RM <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="1">1</button><span id="annotated-cell-43-2" class="code-annotation-target"><a href="#annotated-cell-43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Time) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-43-3"><a href="#annotated-cell-43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_chol =</span> <span class="fu">mean</span>(Cholesterol),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-43" data-target-annotation="2">2</button><span id="annotated-cell-43-4" class="code-annotation-target"><a href="#annotated-cell-43-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SD_chol =</span> <span class="fu">sd</span>(Cholesterol))</span>
<span id="annotated-cell-43-5"><a href="#annotated-cell-43-5" aria-hidden="true" tabindex="-1"></a>anova_rm_table</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-43" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="2" data-code-annotation="1">Groups the data by Time group</span>
</dd>
<dt data-target-cell="annotated-cell-43" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-43" data-code-lines="4" data-code-annotation="2">Calculates the mean and SD Cholesterol values and puts them in columns called mean_chol and SD_chol</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the table">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the table
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Time</th>
<th style="text-align: left;">mean_chol</th>
<th style="text-align: left;">SD_chol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Before</td>
<td style="text-align: left;">6.407778</td>
<td style="text-align: left;">1.191087</td>
</tr>
<tr class="even">
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">5.841667</td>
<td style="text-align: left;">1.123352</td>
</tr>
<tr class="odd">
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">5.778889</td>
<td style="text-align: left;">1.101912</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br><br> Then use the values in the new table to make the bar chart:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-44"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-44-1"><a href="#annotated-cell-44-1" aria-hidden="true" tabindex="-1"></a>anova_rm_table <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="1">1</button><span id="annotated-cell-44-2" class="code-annotation-target"><a href="#annotated-cell-44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="2">2</button><span id="annotated-cell-44-3" class="code-annotation-target"><a href="#annotated-cell-44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>mean_chol), <span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="3">3</button><span id="annotated-cell-44-4" class="code-annotation-target"><a href="#annotated-cell-44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">ymin=</span>mean_chol<span class="sc">-</span>SD_chol, <span class="at">ymax=</span>mean_chol<span class="sc">+</span>SD_chol), <span class="at">width=</span><span class="fl">0.1</span>, <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.75</span>, <span class="at">linewidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="annotated-cell-44-5"><a href="#annotated-cell-44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart of RM ANOVA Cholesterol data"</span>,</span>
<span id="annotated-cell-44-6"><a href="#annotated-cell-44-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bars = standard deviation"</span>,</span>
<span id="annotated-cell-44-7"><a href="#annotated-cell-44-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="4">4</button><span id="annotated-cell-44-8" class="code-annotation-target"><a href="#annotated-cell-44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Before"</span><span class="ot">=</span><span class="st">"At start"</span>, <span class="st">"After.4.weeks"</span><span class="ot">=</span><span class="st">"4 Weeks"</span>, <span class="st">"After.8.weeks"</span><span class="ot">=</span><span class="st">"8 Weeks"</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-44" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-44" data-code-lines="2" data-code-annotation="1">Sends the new table with means and SDs to ggplot()</span>
</dd>
<dt data-target-cell="annotated-cell-44" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-44" data-code-lines="3" data-code-annotation="2">Creates a bar chart with Time on the x-axis and mean cholesterol on the y-axis.</span>
</dd>
<dt data-target-cell="annotated-cell-44" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-44" data-code-lines="4" data-code-annotation="3">Creates error bars from the SD values (mean +/- SD)</span>
</dd>
<dt data-target-cell="annotated-cell-44" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-44" data-code-lines="8" data-code-annotation="4">Changes the names of the Time categories from those in the table to specified labels.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the bar chart">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the bar chart
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/aovrm1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><br> <br> <strong>4. ASSUMPTIONS</strong><br> <strong>Test if the data in the 3 groups are normally distributed</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Time) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(Cholesterol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the Shapiro-Wilk test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the Shapiro-Wilk test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Time</th>
<th style="text-align: left;">variable</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Before</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: right;">0.9819002</td>
<td style="text-align: right;">0.9674667</td>
</tr>
<tr class="even">
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: right;">0.9768682</td>
<td style="text-align: right;">0.9120981</td>
</tr>
<tr class="odd">
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: right;">0.9773254</td>
<td style="text-align: right;">0.9183031</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Here, the data in all 3 groups is normally distributed so we can use the Repeated Measures ANOVA. If the data is NOT normally distributed (P&lt;0.05), use Friedman’s test (see below; this is a non-parametric equivalent of a repeated measures ANOVA)</p>
<p><br><strong>NB</strong> no need for homogeneity of variance test as there are no ‘between’ factors. Sphericity is automatically calculated (Mauchly’s test).</p>
<p><br><br></p>
<section id="the-repeated-measures-anova" class="level6">
<h6 class="anchored" data-anchor-id="the-repeated-measures-anova"><strong>5. THE REPEATED MEASURES ANOVA</strong></h6>
</section>
<section id="if-the-data-is-normally-distributed" class="level6">
<h6 class="anchored" data-anchor-id="if-the-data-is-normally-distributed"><code>5.1</code> <strong>IF THE DATA IS NORMALLY DISTRIBUTED</strong> <br></h6>
<p><code>5.1a</code> <strong>Repeated measures ANOVA</strong>, including Mauchly’s Sphericity test<br></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-46"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-46" data-target-annotation="1">1</button><span id="annotated-cell-46-1" class="code-annotation-target"><a href="#annotated-cell-46-1" aria-hidden="true" tabindex="-1"></a>anova_rm <span class="ot">&lt;-</span> chol_RM <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-46" data-target-annotation="2">2</button><span id="annotated-cell-46-2" class="code-annotation-target"><a href="#annotated-cell-46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(<span class="at">dv =</span> Cholesterol, <span class="at">wid =</span> ID, <span class="at">within =</span> Time, <span class="at">effect.size =</span> <span class="st">"pes"</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-46" data-target-annotation="3">3</button><span id="annotated-cell-46-3" class="code-annotation-target"><a href="#annotated-cell-46-3" aria-hidden="true" tabindex="-1"></a>anova_rm</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-46" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-46" data-code-lines="1" data-code-annotation="1">The chol_RM dataframe is sent to the anova_test() function. Results are stored in a new object called <code>anova_rm</code> (you can call it whatever you like.)</span>
</dd>
<dt data-target-cell="annotated-cell-46" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-46" data-code-lines="2" data-code-annotation="2">dv = the data outcome variable, wid = the subject ID, within = the within-subject grouping variable</span>
</dd>
<dt data-target-cell="annotated-cell-46" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-46" data-code-lines="3" data-code-annotation="3">View the contents of the new anova_RM object</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the anova">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the anova
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

$ANOVA
  Effect DFn DFd       F        p p&lt;.05   pes
1   Time   2  34 212.321 6.17e-20     * 0.926

$`Mauchly's Test for Sphericity`
  Effect     W        p p&lt;.05
1   Time 0.381 0.000444     *

$`Sphericity Corrections`
  Effect   GGe   DF[GG]    p[GG] p[GG]&lt;.05   HFe      DF[HF]    p[HF] p[HF]&lt;.05
1   Time 0.618 1.24, 21 3.89e-13         * 0.642 1.28, 21.82 1.44e-13         *</code></pre>
</div>
</div>
<ul>
<li><p>Output: P-value, pes = partial eta square effect size. <br>pes = 0.01, small effect | pes = 0.06, medium effect | pes = 0.14, large effect</p></li>
<li><p>Sphericity corrections provided: GG = Greenhouse-Geisser; HF = Huynh-Feldt. Use either of these instead of ANOVA if Mauchly’s Test for Sphericity is broken (P&lt;0.05) - as it is in this example!</p></li>
</ul>
</div>
</div>
</div>
<p><br> <br> <code>5.1b</code> <strong>Post-hoc multiple comparison test:</strong><br> ANOVA result is P&lt;0.05, so we want to see which groups differ from which.<br> Use pairwise t-tests adjusted with Bonferroni correction (use ‘p.adj’ P-values.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-47"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-47-1"><a href="#annotated-cell-47-1" aria-hidden="true" tabindex="-1"></a>aov_rm_phoc <span class="ot">&lt;-</span> chol_RM <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-47" data-target-annotation="1">1</button><span id="annotated-cell-47-2" class="code-annotation-target"><a href="#annotated-cell-47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(Cholesterol <span class="sc">~</span> Time, <span class="at">paired =</span> T, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="annotated-cell-47-3"><a href="#annotated-cell-47-3" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-47" data-target-annotation="2">2</button><span id="annotated-cell-47-4" class="code-annotation-target"><a href="#annotated-cell-47-4" aria-hidden="true" tabindex="-1"></a>aov_rm_phoc</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-47" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-47" data-code-lines="2" data-code-annotation="1">chol_RM dataframe sent to pairwise test; Cholesterol data is grouped by Time</span>
</dd>
<dt data-target-cell="annotated-cell-47" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-47" data-code-lines="4" data-code-annotation="2">Results are stored in a new object called <code>aov_rm_phoc</code></span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the multiple comparison">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the multiple comparison
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 11%">
<col style="width: 3%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: left;">group1</th>
<th style="text-align: left;">group2</th>
<th style="text-align: left;">n1</th>
<th style="text-align: left;">n2</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">p.adj</th>
<th style="text-align: left;">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">15.438873</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">14.945968</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">3.780903</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">0.001</td>
<td style="text-align: left;">0.004</td>
<td style="text-align: left;">**</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br><br><br></p>
</section>
<section id="if-the-data-is-not-normally-distributed-1" class="level6">
<h6 class="anchored" data-anchor-id="if-the-data-is-not-normally-distributed-1"><code>5.2</code>. <strong>IF THE DATA IS NOT NORMALLY DISTRIBUTED</strong></h6>
<p><code>5.2a</code> <strong>The Friedman test</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-48"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-48-1"><a href="#annotated-cell-48-1" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-48" data-target-annotation="1">1</button><span id="annotated-cell-48-2" class="code-annotation-target"><a href="#annotated-cell-48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">friedman_test</span>(Cholesterol <span class="sc">~</span> Time <span class="sc">|</span> ID)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-48" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-48" data-code-lines="2" data-code-annotation="1">Friedman test carried out on the Cholesterol data grouped by Time category, and ordered by the ID number of each person</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the Friedman test">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the Friedman test
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: left;">n</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">29.77778</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">3e-07</td>
<td style="text-align: left;">Friedman test</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>P=3x10<sup>-7</sup>, much less than 0.05, and so there is a statistically signticant difference</p>
</div>
</div>
</div>
<p><br><br> <code>5.2b</code> <strong>Effect size</strong><br> Uses the Kendall W effect size measure. The output interprets the value for you.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">friedman_effsize</span>(Cholesterol <span class="sc">~</span> Time <span class="sc">|</span> ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the effect size">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-47-contents" aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the effect size
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-47" class="callout-47-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">effsize</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">magnitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">0.8271605</td>
<td style="text-align: left;">Kendall W</td>
<td style="text-align: left;">large</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br><br> <code>5.2c</code> <strong>Multiple comparison (Wilcoxon signed rank test)</strong><br> Do this if the Friedman test gives a P-value &lt;0.05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>chol_RM <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_test</span>(Cholesterol <span class="sc">~</span> Time, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the multiple comparisons">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the multiple comparisons
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">.y.</th>
<th style="text-align: left;">group1</th>
<th style="text-align: left;">group2</th>
<th style="text-align: right;">n1</th>
<th style="text-align: right;">n2</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">p.adj</th>
<th style="text-align: left;">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">171.0</td>
<td style="text-align: right;">2.13e-04</td>
<td style="text-align: right;">6.39e-04</td>
<td style="text-align: left;">***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Before</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">171.0</td>
<td style="text-align: right;">7.60e-06</td>
<td style="text-align: right;">2.29e-05</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">After.4.weeks</td>
<td style="text-align: left;">After.8.weeks</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">152.5</td>
<td style="text-align: right;">4.00e-03</td>
<td style="text-align: right;">1.10e-02</td>
<td style="text-align: left;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Use the p.adj P-values; these are adjusted by the Bonferroni correction to reduce the chance of a Type 1 error.<br><br>Here, all groups are statistically signnificantly different to every other group</p>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>This uses the same data as for the 1-Factor Anova example, but in this case we also have the age of each participant. We know that cholesterol is affected by age (from previous studies), so we want to control for this variable and analyse only if drug treatment group (control, drug 1 or drug 2) influences cholesterol levels irrespective of age.</p>
<p><br><code>1.</code> <strong>Download the data</strong><br> Download the excel file <code>ANCOVA_cholesterol.xlsx</code> from Canvas to your Downloads folder and make it available to RStudio.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Upload excel file to RStudio Cloud">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-49-contents" aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Upload excel file to RStudio Cloud
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-49" class="callout-49-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Check that the data in the file is ‘tidy’</li>
<li>Upload it to RStudio Cloud, saving it to a folder for this Statistics Workshop 2 session (<em>NB</em> If you are using RStudio on your own laptop, simply save the excel file to a relevant folder on your laptop).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="upload%20ANCOVA.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Uploading a file to RStudio"><img src="upload%20ANCOVA.png" class="img-fluid figure-img" style="width:70.0%" alt="Uploading a file to RStudio"></a></p>
<figcaption>Uploading a file to RStudio</figcaption>
</figure>
</div>
<ul>
<li>In RStudio, locate the file and set the folder location as your working directory.</li>
</ul>
</div>
</div>
</div>
<p><br></p>
<p><code>2.</code> <strong>Import the data and save it as a dataframe called <em>ancova_chol</em>:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-54"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-54" data-target-annotation="1">1</button><span id="annotated-cell-54-1" class="code-annotation-target"><a href="#annotated-cell-54-1" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"ANCOVA_cholesterol.xlsx"</span>)</span>
<span id="annotated-cell-54-2"><a href="#annotated-cell-54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-54-3"><a href="#annotated-cell-54-3" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-54" data-target-annotation="2">2</button><span id="annotated-cell-54-4" class="code-annotation-target"><a href="#annotated-cell-54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-54" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-54" data-code-lines="1" data-code-annotation="1">Import the data, save it as a dataframe called ‘ancova_chol’</span>
</dd>
<dt data-target-cell="annotated-cell-54" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-54" data-code-lines="4" data-code-annotation="2">View the 1st 6 rows</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the first 6 rows of the dataframe">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-50-contents" aria-controls="callout-50" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the first 6 rows of the dataframe
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-50" class="callout-50-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">137</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">61.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">115</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">55.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">144</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">63.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">173</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">77.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">153</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">68.85</td>
</tr>
<tr class="even">
<td style="text-align: left;">144</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">64.80</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br> Check the data types of each column:<br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the data types of each variable">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the data types of each variable
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">character</td>
<td style="text-align: left;">numeric</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The Group variable is a character (text) variable. The other two are numeric.</p>
</div>
</div>
</div>
<p><br></p>
<p>You can see that the Group variable is a character (text) variable. However, the Group variable contains categories of treatment, so change it to a factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-56"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-56-1"><a href="#annotated-cell-56-1" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="ot">&lt;-</span> ancova_chol <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-56" data-target-annotation="1">1</button><span id="annotated-cell-56-2" class="code-annotation-target"><a href="#annotated-cell-56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Group =</span> <span class="fu">as.factor</span>(Group))</span>
<span id="annotated-cell-56-3"><a href="#annotated-cell-56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-56-4"><a href="#annotated-cell-56-4" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="sc">|&gt;</span></span>
<span id="annotated-cell-56-5"><a href="#annotated-cell-56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(class)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-56" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-56" data-code-lines="2" data-code-annotation="1">sends the ancova_chol dataframe to <code>mutate()</code> which converts Group to be a factor. Saves the changed dataframe to one with the same name (<em>ie</em> it over-writes the dataframe)</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the data types of each variable">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-52-contents" aria-controls="callout-52" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the data types of each variable
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-52" class="callout-52-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cholesterol</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">Age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">factor</td>
<td style="text-align: left;">numeric</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>You can see that the Group variable is now a factor.</p>
</div>
</div>
</div>
<p><br> <br>Save the dataframe as an RData file so that you don’t have to do the above again:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ancova_chol, <span class="at">file =</span> <span class="st">"ancova_chol.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br><br> <code>3.</code> <strong>Explore the data</strong> <br> <code>3a.</code> <strong>Descriptive statistics</strong><br> <br> First, get summary descriptive statistics for Cholesterol grouped by treatment Group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(Cholesterol <span class="sc">~</span> Group, <span class="at">data =</span> ancova_chol, <span class="at">quant =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the summary descriptive statistics for Cholesterol">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-53-contents" aria-controls="callout-53" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the summary descriptive statistics for Cholesterol
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-53" class="callout-53-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
Group: Control
            vars  n   mean    sd median trimmed   mad min max range  skew
Cholesterol    1 20 140.45 21.18  138.5  141.38 24.46 102 173    71 -0.15
            kurtosis   se Q0.25 Q0.75
Cholesterol    -1.14 4.74 128.5   162
------------------------------------------------------------ 
Group: Drug_1
            vars  n  mean    sd median trimmed   mad min max range  skew
Cholesterol    1 20 118.1 21.56  114.5  118.56 26.69  82 151    69 -0.03
            kurtosis   se Q0.25 Q0.75
Cholesterol    -1.29 4.82 101.5 135.5
------------------------------------------------------------ 
Group: Drug_2
            vars  n   mean    sd median trimmed   mad min max range skew
Cholesterol    1 20 102.55 16.94    101  101.88 17.79  80 130    50 0.33
            kurtosis   se Q0.25 Q0.75
Cholesterol    -1.25 3.79 88.25 111.5</code></pre>
</div>
</div>
<p>You can see that the mean values for Control, Drug 1 and Drug 1 are 140.5, 118.1 and 102.6, respectively.</p>
</div>
</div>
</div>
<p><br>and then obtain the summary descriptive statistics for Age grouped by treatment Group:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describeBy</span>(Age <span class="sc">~</span> Group, <span class="at">data =</span> ancova_chol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the summary descriptive statistics for Age">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-54-contents" aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the summary descriptive statistics for Age
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-54" class="callout-54-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
 Descriptive statistics by group 
Group: Control
    vars  n  mean  sd median trimmed  mad min   max range  skew kurtosis   se
Age    1 20 61.31 8.7  61.32   61.64 5.45  41 77.85 36.85 -0.26        0 1.95
------------------------------------------------------------ 
Group: Drug_1
    vars  n  mean    sd median trimmed   mad  min   max range skew kurtosis  se
Age    1 20 63.82 10.74  64.12   63.62 12.31 45.1 83.05 37.95 0.03    -1.12 2.4
------------------------------------------------------------ 
Group: Drug_2
    vars  n  mean  sd median trimmed  mad min max range skew kurtosis  se
Age    1 20 42.33 7.6   40.6   41.86 7.12  32  57    25 0.47    -1.14 1.7</code></pre>
</div>
</div>
<p>You can see that the mean age for the Drug 2 group is lower than for the other two groups.</p>
</div>
</div>
</div>
<p><br><code>3b.</code> <strong>Bar chart</strong><br>First, calculate mean &amp; standard error (SE) cholesterol for each treatment group and save in an object called ‘ancova_mean_table’:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-60"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-60-1"><a href="#annotated-cell-60-1" aria-hidden="true" tabindex="-1"></a>ancova_mean_table <span class="ot">&lt;-</span> ancova_chol <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-60" data-target-annotation="1">1</button><span id="annotated-cell-60-2" class="code-annotation-target"><a href="#annotated-cell-60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Group) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-60-3"><a href="#annotated-cell-60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_chol =</span> <span class="fu">mean</span>(Cholesterol),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-60" data-target-annotation="2">2</button><span id="annotated-cell-60-4" class="code-annotation-target"><a href="#annotated-cell-60-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">SE_chol =</span> <span class="fu">se</span>(Cholesterol))</span>
<span id="annotated-cell-60-5"><a href="#annotated-cell-60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-60-6"><a href="#annotated-cell-60-6" aria-hidden="true" tabindex="-1"></a>ancova_mean_table </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-60" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-60" data-code-lines="2" data-code-annotation="1">Sends ancova_chol to group_by() which groups the data by treatment Group</span>
</dd>
<dt data-target-cell="annotated-cell-60" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-60" data-code-lines="4" data-code-annotation="2">Creates new columns for mean and SE of cholesterol, placing them in columns titles ‘mean_chol’ and ‘SE_chol’</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the mean and se values">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-55-contents" aria-controls="callout-55" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the mean and se values
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-55" class="callout-55-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Group</th>
<th style="text-align: left;">mean_chol</th>
<th style="text-align: left;">SE_chol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: left;">140.45</td>
<td style="text-align: left;">4.736463</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">118.10</td>
<td style="text-align: left;">4.820952</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">102.55</td>
<td style="text-align: left;">3.787427</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br>Use the new table object to create the bar chart:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-61"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-61-1"><a href="#annotated-cell-61-1" aria-hidden="true" tabindex="-1"></a>ancova_mean_table <span class="sc">|&gt;</span></span>
<span id="annotated-cell-61-2"><a href="#annotated-cell-61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="1">1</button><span id="annotated-cell-61-3" class="code-annotation-target"><a href="#annotated-cell-61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>mean_chol), <span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"lightblue"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-61" data-target-annotation="2">2</button><span id="annotated-cell-61-4" class="code-annotation-target"><a href="#annotated-cell-61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">ymin=</span>mean_chol<span class="sc">-</span>SE_chol, <span class="at">ymax=</span>mean_chol<span class="sc">+</span>SE_chol), <span class="at">width=</span><span class="fl">0.1</span>, <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.75</span>, <span class="at">linewidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="annotated-cell-61-5"><a href="#annotated-cell-61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart of Cholesterol data"</span>,</span>
<span id="annotated-cell-61-6"><a href="#annotated-cell-61-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bars = standard error"</span>,</span>
<span id="annotated-cell-61-7"><a href="#annotated-cell-61-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-61" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="3" data-code-annotation="1">Uses the mean and se values in the table to create a bar chart with Group on the x-axis and the mean cholesterolo on the y-axis</span>
</dd>
<dt data-target-cell="annotated-cell-61" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-61" data-code-lines="4" data-code-annotation="2">Creates error bars using the SE values in the table (mean +/- SE)</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the bar chart">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-56-contents" aria-controls="callout-56" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the bar chart
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-56" class="callout-56-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/anc_mean1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br> <br><code>4.</code> <strong>Check assumptions of ANCOVA:</strong><br> <code>A.</code> Check relationship of covariate (Age) and outcome (Cholesterol) is linear in the 3 groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-62"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-62-1"><a href="#annotated-cell-62-1" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-62" data-target-annotation="1">1</button><span id="annotated-cell-62-2" class="code-annotation-target"><a href="#annotated-cell-62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggscatter</span>(<span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">y =</span> <span class="st">"Cholesterol"</span>, <span class="at">color =</span> <span class="st">"Group"</span>, <span class="at">add =</span> <span class="st">"reg.line"</span>)<span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-62" data-target-annotation="2">2</button><span id="annotated-cell-62-3" class="code-annotation-target"><a href="#annotated-cell-62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_regline_equation</span>(<span class="fu">aes</span>(<span class="at">label =</span>  <span class="fu">paste</span>(<span class="fu">after_stat</span>(eq.label), <span class="fu">after_stat</span>(rr.label), <span class="at">sep =</span> <span class="st">"~~~~"</span>), <span class="at">color =</span> Group))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-62" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-62" data-code-lines="2" data-code-annotation="1">Creates a scatter plot with Age on the x-axis and Cholesterol on the y-axis, coloured by Group, and adds a regression line</span>
</dd>
<dt data-target-cell="annotated-cell-62" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-62" data-code-lines="3" data-code-annotation="2">Adds regression equations for each Group Group</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the scatter plot">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the scatter plot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/ancova_assump2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br><br> <code>B</code>. Homogeneity of regression slopes. <br>The slopes of the regression lines, formed by the covariate (Age) and the outcome variable (Cholesterol), should be the same for each group.<br></p>
<p><br>Tested with the interaction term: here, interaction term of ‘Group:Age’ P should be &gt; 0.05 (slopes are not different).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="sc">%&gt;%</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cholesterol <span class="sc">~</span> Group<span class="sc">*</span>Age, <span class="at">effect.size =</span> <span class="st">'pes'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the interaction term for the homogeneity of regression slopes">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-58-contents" aria-controls="callout-58" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the interaction term for the homogeneity of regression slopes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-58" class="callout-58-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: left;">DFn</th>
<th style="text-align: left;">DFd</th>
<th style="text-align: left;">F</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">p&lt;.05</th>
<th style="text-align: left;">pes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">73.136</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">*</td>
<td style="text-align: left;">0.730</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">347.126</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">*</td>
<td style="text-align: left;">0.865</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group:Age</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">0.420</td>
<td style="text-align: left;">0.659</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">0.015</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here, the Group:Age interaction term P = 0.659, and so the slopes of the 3 lines are not significantly different.<br><br> <em>NB</em> ‘pes’ = partial eta squared effect size:<br> eta<sup>2</sup> of 0.01 = small effect,<br>eta<sup>2</sup> of 0.06 = medium effect,<br>eta<sup>2</sup> of 0.14 = large effect.</p>
</div>
</div>
</div>
<p><br><br> <code>C</code>. Homogeneity of variance for outcomes (cholesterol levels) for each group <br>(P should be &gt;0.05):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ancova_chol <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">levene_test</span>(Cholesterol <span class="sc">~</span> Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the homogeneity of variance">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-59-contents" aria-controls="callout-59" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the homogeneity of variance
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-59" class="callout-59-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">df1</th>
<th style="text-align: left;">df2</th>
<th style="text-align: left;">statistic</th>
<th style="text-align: left;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">0.688909</td>
<td style="text-align: left;">0.5062551</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p><br><br> <code>5.</code> <strong>The ANCOVA</strong> <br><code>a.</code> <strong>The analysis:</strong><br> Enter the covariate (here, it is ‘Age’) into the model first - we want to remove the effect of this first before analysing effect of Group.<br> The result is stored in an object called <code>df_ancov</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-65"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-65-1"><a href="#annotated-cell-65-1" aria-hidden="true" tabindex="-1"></a>df_ancov <span class="ot">&lt;-</span> ancova_chol <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-65" data-target-annotation="1">1</button><span id="annotated-cell-65-2" class="code-annotation-target"><a href="#annotated-cell-65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(Cholesterol <span class="sc">~</span> Age <span class="sc">+</span> Group, <span class="at">effect.size =</span> <span class="st">'pes'</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-65" data-target-annotation="2">2</button><span id="annotated-cell-65-3" class="code-annotation-target"><a href="#annotated-cell-65-3" aria-hidden="true" tabindex="-1"></a>df_ancov</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-65" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-65" data-code-lines="2" data-code-annotation="1">Dataframe sent to anova_test: outcome grouped by covariate + grouping variable. Result stored in a new object called <code>df_ancov</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-65" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-65" data-code-lines="3" data-code-annotation="2">View the results of the ANCOVA</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the ANCOVA">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-60-contents" aria-controls="callout-60" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the ANCOVA
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-60" class="callout-60-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Effect</th>
<th style="text-align: left;">DFn</th>
<th style="text-align: left;">DFd</th>
<th style="text-align: left;">F</th>
<th style="text-align: left;">p</th>
<th style="text-align: left;">p&lt;.05</th>
<th style="text-align: left;">pes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">56</td>
<td style="text-align: left;">354.471</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">*</td>
<td style="text-align: left;">0.864</td>
</tr>
<tr class="even">
<td style="text-align: left;">Group</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">56</td>
<td style="text-align: left;">74.684</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">*</td>
<td style="text-align: left;">0.727</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>NB</em> ‘pes’ = partial eta squared effect size:<br> eta<sup>2</sup> of 0.01 = small effect,<br>eta<sup>2</sup> of 0.06 = medium effect,<br>eta<sup>2</sup> of 0.14 = large effect.<br> <br> The statistical significance (P) of the effect of Group on Cholesterol is 1.58 x 10<sup>-16</sup> when the effect of age is removed (Without removing age, the effect of group was P = 8 x 10<sup>-7</sup>; see 1-Factor ANOVA tab section 5.1).</p>
</div>
</div>
</div>
<p>Because P&lt;0.05, we need to do a post-hoc comparison test to find out which group is different from which.<br> (<em>NB</em> this also calculates the adjusted means, so is useful to do even if P&gt;0.05).</p>
<p><br><code>b.</code> <strong>Post-hoc comparison test:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-66"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-66-1"><a href="#annotated-cell-66-1" aria-hidden="true" tabindex="-1"></a>phc <span class="ot">&lt;-</span> ancova_chol <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-66-2"><a href="#annotated-cell-66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans_test</span>(Cholesterol <span class="sc">~</span> Group, <span class="at">covariate =</span> Age,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-66" data-target-annotation="1">1</button><span id="annotated-cell-66-3" class="code-annotation-target"><a href="#annotated-cell-66-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-66" data-target-annotation="2">2</button><span id="annotated-cell-66-4" class="code-annotation-target"><a href="#annotated-cell-66-4" aria-hidden="true" tabindex="-1"></a>phc</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-66" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-66" data-code-lines="3" data-code-annotation="1">Dataframe sent to emmeans_test to do a multiple comparison with adjusted means (adjusted for Age). Calculates this for Cholesterol grouped by Group, adjusting for the covariate Age. Bonferroni correction to reduce the chance of a Type 1 error.</span>
</dd>
<dt data-target-cell="annotated-cell-66" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-66" data-code-lines="4" data-code-annotation="2">The results of the multiple comparison are stored in an object called <code>phc</code>, so run this object name to see contents.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the result of the multiple comparison">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-61-contents" aria-controls="callout-61" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the result of the multiple comparison
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-61" class="callout-61-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: left;">.y.</th>
<th style="text-align: left;">group1</th>
<th style="text-align: left;">group2</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">p.adj</th>
<th style="text-align: left;">p.adj.signif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age*Group</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">11.5802885</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age*Group</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">-0.2700763</td>
<td style="text-align: right;">0.7880944</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">ns</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age*Group</td>
<td style="text-align: left;">Cholesterol</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">-8.5451078</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">****</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>‘p.adj’ reported are the adjusted p-values for comparisons between groups for Cholesterol, adjusted by covariate (Age) and bonferroni correction.<br> <br>Here, The Control and Drug_1 and the Drug_1 and Drug_2 cholesterol levels are significantly different. The Drug_2 group is not sig different to the Control group.</p>
</div>
</div>
</div>
<p><br><code>c.</code> <strong>The estimated marginal means (= adjusted means) for each group:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-67"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-67" data-target-annotation="1">1</button><span id="annotated-cell-67-1" class="code-annotation-target"><a href="#annotated-cell-67-1" aria-hidden="true" tabindex="-1"></a>adj.means <span class="ot">&lt;-</span><span class="fu">get_emmeans</span>(phc)</span>
<span id="annotated-cell-67-2"><a href="#annotated-cell-67-2" aria-hidden="true" tabindex="-1"></a>adj.means</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-67" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-67" data-code-lines="1" data-code-annotation="1">Gets the estimated marginal means from the phs object created above, and stores them in another object called <code>adj.means</code>. To see them, run the object name.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the estimated marginal (adjusted) means">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-62-contents" aria-controls="callout-62" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the estimated marginal (adjusted) means
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-62" class="callout-62-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Age</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">emmean</th>
<th style="text-align: left;">se</th>
<th style="text-align: left;">df</th>
<th style="text-align: left;">conf.low</th>
<th style="text-align: left;">conf.high</th>
<th style="text-align: left;">method</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">55.82083</td>
<td style="text-align: left;">Control</td>
<td style="text-align: left;">129.2446</td>
<td style="text-align: left;">1.769874</td>
<td style="text-align: left;">56</td>
<td style="text-align: left;">125.69912</td>
<td style="text-align: left;">132.7901</td>
<td style="text-align: left;">Emmeans test</td>
</tr>
<tr class="even">
<td style="text-align: left;">55.82083</td>
<td style="text-align: left;">Drug_1</td>
<td style="text-align: left;">101.7657</td>
<td style="text-align: left;">1.879078</td>
<td style="text-align: left;">56</td>
<td style="text-align: left;">98.00143</td>
<td style="text-align: left;">105.5299</td>
<td style="text-align: left;">Emmeans test</td>
</tr>
<tr class="odd">
<td style="text-align: left;">55.82083</td>
<td style="text-align: left;">Drug_2</td>
<td style="text-align: left;">130.0897</td>
<td style="text-align: left;">2.217625</td>
<td style="text-align: left;">56</td>
<td style="text-align: left;">125.64728</td>
<td style="text-align: left;">134.5321</td>
<td style="text-align: left;">Emmeans test</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So, these mean cholesterol values have changed from Control = 140, Drug 1 = 118 and Drug 2 = 103 to 129, 102 and 130, respectively, after the influence of age was removed.</p>
</div>
</div>
</div>
<p>Compare the bar chart at the start of this section with the one below which shows the estimated marginal means, adjusted for Age.</p>
<p><br><strong>Bar chart with the adjusted means:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-68"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-68" data-target-annotation="1">1</button><span id="annotated-cell-68-1" class="code-annotation-target"><a href="#annotated-cell-68-1" aria-hidden="true" tabindex="-1"></a>adj.means <span class="sc">|&gt;</span></span>
<span id="annotated-cell-68-2"><a href="#annotated-cell-68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="annotated-cell-68-3"><a href="#annotated-cell-68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>emmean), <span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-68" data-target-annotation="2">2</button><span id="annotated-cell-68-4" class="code-annotation-target"><a href="#annotated-cell-68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">ymin=</span>emmean<span class="sc">-</span>se, <span class="at">ymax=</span>emmean<span class="sc">+</span>se), <span class="at">width=</span><span class="fl">0.1</span>, <span class="at">colour=</span><span class="st">"black"</span>, <span class="at">alpha=</span><span class="fl">0.75</span>, <span class="at">linewidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="annotated-cell-68-5"><a href="#annotated-cell-68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Bar chart of adjusted means for ANCOVA Cholesterol data"</span>, </span>
<span id="annotated-cell-68-6"><a href="#annotated-cell-68-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Bars = standard error"</span>, </span>
<span id="annotated-cell-68-7"><a href="#annotated-cell-68-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Cholesterol (mg/dL)"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-68" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-68" data-code-lines="1" data-code-annotation="1">Sends the <code>adj.means</code> contents to ggplot() which creates a bar chart with Group on the x-axis and the adjusted means on the y-axis</span>
</dd>
<dt data-target-cell="annotated-cell-68" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-68" data-code-lines="4" data-code-annotation="2">Error bars created of mean +/- se for each Group.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Click to see the bar chart with the estimated marginal (adjusted) means">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-63-contents" aria-controls="callout-63" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click to see the bar chart with the estimated marginal (adjusted) means
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-63" class="callout-63-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Stats-workshop-2_files/figure-html/ancovabaremm1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>